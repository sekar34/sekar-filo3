<!DOCTYPE html>
<html lang="tr">
<head>
  <meta charset="UTF-8">
  <title>SEKAR FÄ°LO YÃ–NETÄ°M HÄ°ZMETLERÄ°</title>
  <style>
    body { font-family: Arial, sans-serif; margin: 0; background: #f4f6f5; color: #333; }
    header { display: flex; align-items: center; background: #006f3c; padding: 15px; justify-content: center; position:relative; }
    header h1 { color: white; margin: 0; font-size: 24px; }
    #currentUser { position:absolute; left:20px; top:20px; color:#fff; font-weight:bold; }
    h2 { color: #006f3c; }
    .menu { text-align: center; margin: 20px; }
    .menu button { margin: 10px; padding: 12px 25px; background: #009e52; border: none; color: white; cursor: pointer; border-radius: 5px; font-size: 16px; }
    .menu button:hover { background: #007a3c; }
    .page { display: none; margin: 20px; padding: 20px; background: white; border-radius: 8px; box-shadow: 0 0 8px rgba(0,0,0,0.1); }
    .login-page { display: flex; flex-direction: column; align-items: center; justify-content: center; height: 100vh; }
    .login-box { background: white; padding: 30px; border-radius: 10px; box-shadow: 0 0 8px rgba(0,0,0,0.2); width: 300px; }
    .login-box input { width: 100%; padding: 10px; margin: 8px 0; border: 1px solid #ccc; border-radius: 5px; }
    .login-box button { width: 100%; padding: 10px; background: #006f3c; color: white; border: none; border-radius: 5px; cursor: pointer; }
    .login-box button:hover { background: #004f2a; }
    .logout-btn { position: absolute; top: 20px; right: 20px; padding: 8px 16px; background: #900; color: white; border: none; border-radius: 5px; cursor: pointer; }
    .logout-btn:hover { background: #600; }
    table { width: 100%; border-collapse: collapse; margin-top: 20px; font-size: 14px; }
    th,td{ border:1px solid #ccc; padding:6px; text-align:center; }
    th{ background:#006f3c; color:white; }
  </style>
</head>
<body>

<!-- LOGIN -->
<div id="loginPage" class="login-page">
  <div class="login-box">
    <h2>SEKAR FÄ°LO GÄ°RÄ°Åž</h2>
    <input type="email" id="email" placeholder="Email">
    <input type="password" id="password" placeholder="Åžifre">
    <button onclick="login()">GiriÅŸ Yap</button>
    <button onclick="register()">KayÄ±t Ol</button>
    <p id="loginError" style="color:red; display:none;">HatalÄ± giriÅŸ!</p>
  </div>
</div>

<!-- ANA SAYFA -->
<div id="mainPage" style="display:none;">
  <header>
    <span id="currentUser"></span>
    <h1>SEKAR FÄ°LO YÃ–NETÄ°M HÄ°ZMETLERÄ°</h1>
    <button class="logout-btn" onclick="logout()">Ã‡Ä±kÄ±ÅŸ Yap</button>
  </header>

  <div class="menu">
    <button onclick="showPage('onay')">ONAY NO</button>
    <button onclick="showPage('ikame')">Ä°KAME ARAÃ‡</button>
    <button onclick="showPage('teslim')">ARAÃ‡ TESLÄ°M</button>
    <button onclick="showPage('bilgi')">ARAÃ‡/FÄ°RMA BÄ°LGÄ°LERÄ°</button>
    <button onclick="showPage('password')">ðŸ”‘ ÅžÄ°FRE DEÄžÄ°ÅžTÄ°R</button>
    <button id="adminBtn" style="display:none;" onclick="showPage('admin')">ðŸ‘‘ ADMIN PANELÄ°</button>
  </div>

  <!-- Ã–RNEK: SADECE ONAY NO FORMU GÃ–STERÄ°YORUM -->
  <div id="onay" class="page">
    <h2>ONAY NO</h2>
    <form id="onayForm">
      Tarih: <input type="date" id="onayTarih" required>
      Plaka: <input type="text" id="onayPlaka" required>
      Firma: <input type="text" id="onayFirma" required>
      Km: <input type="number" id="onayKm" required>
      Servis: <input type="text" id="onayServis" required>
      Durum: <input type="text" id="onayDurum" required>
      AÃ§Ä±klama: <input type="text" id="onayAciklama">
      Tutar: <input type="number" id="onayTutar" required>
      <button type="button" onclick="submitOnay()">Kaydet</button>
    </form>
    <table id="onayTable"><tbody></tbody></table>
  </div>

</div>

<!-- Firebase SDK -->
<script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>
<script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-auth.js"></script>
<script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-database.js"></script>

<script>
const firebaseConfig = {
  apiKey: "AIzaSyB-xEmeTVN8oiB4FZzV4UpJpAHkyDHYF4U",
  authDomain: "sekar-filo.firebaseapp.com",
  databaseURL: "https://sekar-filo-default-rtdb.europe-west1.firebasedatabase.app",
  projectId: "sekar-filo",
  storageBucket: "sekar-filo.appspot.com",
  messagingSenderId: "61274893830",
  appId: "1:61274893830:web:c9dfdf8baf0500178f9d87"
};
firebase.initializeApp(firebaseConfig);
const auth = firebase.auth();
const db = firebase.database();

// === AUTH ===
function login() {
  let email = document.getElementById("email").value;
  let pass = document.getElementById("password").value;
  auth.signInWithEmailAndPassword(email, pass).then(u=>{
    document.getElementById("loginPage").style.display="none";
    document.getElementById("mainPage").style.display="block";
    document.getElementById("currentUser").innerText=email;
    loadOnay();
  }).catch(()=>document.getElementById("loginError").style.display="block");
}
function register() {
  let email = document.getElementById("email").value;
  let pass = document.getElementById("password").value;
  auth.createUserWithEmailAndPassword(email, pass).then(cred=>{
    db.ref("users/"+cred.user.uid).set({email:email,role:"user"});
    alert("KayÄ±t baÅŸarÄ±lÄ± âœ…");
  }).catch(err=>alert("Hata: "+err.message));
}
function logout() {
  auth.signOut().then(()=>{
    document.getElementById("mainPage").style.display="none";
    document.getElementById("loginPage").style.display="flex";
  });
}

// === ONAY ===
function submitOnay(){
  let rec={
    tarih: document.getElementById("onayTarih").value,
    plaka: document.getElementById("onayPlaka").value,
    firma: document.getElementById("onayFirma").value,
    km: document.getElementById("onayKm").value,
    servis: document.getElementById("onayServis").value,
    durum: document.getElementById("onayDurum").value,
    aciklama: document.getElementById("onayAciklama").value,
    tutar: document.getElementById("onayTutar").value
  };
  db.ref("onayRecords").push(rec).then(()=>loadOnay());
  document.getElementById("onayForm").reset();
}
function loadOnay(){
  db.ref("onayRecords").on("value",snap=>{
    let tb=document.querySelector("#onayTable tbody");tb.innerHTML="";
    snap.forEach(ch=>{
      let r=ch.val();
      let tr=document.createElement("tr");
      tr.innerHTML=`<td>${r.tarih}</td><td>${r.plaka}</td><td>${r.firma}</td><td>${r.km}</td><td>${r.servis}</td><td>${r.durum}</td><td>${r.aciklama}</td><td>${r.tutar}</td>`;
      tb.appendChild(tr);
    });
  });
}
</script>
</body>
</html>
